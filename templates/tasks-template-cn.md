---

description: "功能实现的任务列表模板"
---

# 任务列表：[功能名称]

**输入**: 来自 `/specs/[###-功能名称]/` 的设计文档
**前提条件**: plan.md (必填), spec.md (用户故事必填), research.md, data-model.md, contracts/

**测试**: 下方的示例包含测试任务。测试是可选的 —— 仅在功能规格说明中明确要求时才包含。

**组织结构**: 任务按用户故事分组，以便能够独立实现和测试每个故事。

## 格式：`[ID] [P?] [故事] 描述`

- **[P]**: 可以并行运行（不同文件，无依赖关系）
- **[故事]**: 该任务属于哪个用户故事（例如 US1, US2, US3）
- 在描述中包含准确的文件路径

## 路径约定

- **单项目**: `src/`, `tests/` 位于仓库根目录
- **Web 应用**: `backend/src/`, `frontend/src/`
- **移动端**: `api/src/`, `ios/src/` 或 `android/src/`
- 下方显示的路径假设为单项目 —— 请根据 plan.md 结构进行调整

<!-- 
  ============================================================================
  重要提示：下方的任务仅为示例，仅用于说明目的。
  
  /speckit.tasks 命令必须根据以下内容替换为实际任务：
  - 来自 spec.md 的用户故事（及其优先级 P1, P2, P3...）
  - 来自 plan.md 的功能需求
  - 来自 data-model.md 的实体
  - 来自 contracts/ 的端点
  
  任务必须按用户故事组织，以便每个故事都可以：
  - 独立实现
  - 独立测试
  - 作为 MVP 增量交付
  
  请勿在生成的 tasks.md 文件中保留这些示例任务。
  ============================================================================
-->

## 第 1 阶段：设置（共享基础设施）

**目的**: 项目初始化和基础结构

- [ ] T001 根据实现计划创建项目结构
- [ ] T002 使用 [框架] 依赖项初始化 [语言] 项目
- [ ] T003 [P] 配置 lint 和格式化工具

---

## 第 2 阶段：基础工作（阻塞性前提条件）

**目的**: 在实现任何用户故事之前必须完成的核心基础设施

**⚠️ 关键**: 在此阶段完成之前，不能开始任何用户故事的工作

基础任务示例（根据您的项目进行调整）：

- [ ] T004 设置数据库模式 (schema) 和迁移 (migrations) 框架
- [ ] T005 [P] 实现认证/授权框架
- [ ] T006 [P] 设置 API 路由和中间件结构
- [ ] T007 创建所有故事都依赖的基础模型/实体
- [ ] T008 配置错误处理和日志基础设施
- [ ] T009 设置环境变量配置管理

**检查点**: 基础就绪 —— 现在可以开始并行实现用户故事

---

## 第 3 阶段：用户故事 1 - [标题] (优先级：P1) 🎯 MVP

**目标**: [简要描述此故事交付的内容]

**独立测试**: [如何验证此故事独立运行]

### 用户故事 1 的测试（可选 —— 仅在要求测试时包含） ⚠️

> **注意：先编写这些测试，确保在实现之前它们是失败 (FAIL) 的**

- [ ] T010 [P] [US1] 在 tests/contract/test_[名称].py 中为 [端点] 编写契约测试
- [ ] T011 [P] [US1] 在 tests/integration/test_[名称].py 中为 [用户旅程] 编写集成测试

### 用户故事 1 的实现

- [ ] T012 [P] [US1] 在 src/models/[实体1].py 中创建 [实体1] 模型
- [ ] T013 [P] [US1] 在 src/models/[实体2].py 中创建 [实体2] 模型
- [ ] T014 [US1] 在 src/services/[服务].py 中实现 [服务]（依赖于 T012, T013）
- [ ] T015 [US1] 在 src/[位置]/[文件].py 中实现 [端点/功能]
- [ ] T016 [US1] 添加验证和错误处理
- [ ] T017 [US1] 为用户故事 1 的操作添加日志

**检查点**: 此时，用户故事 1 应具备完整功能并可独立测试

---

## 第 4 阶段：用户故事 2 - [标题] (优先级：P2)

**目标**: [简要描述此故事交付的内容]

**独立测试**: [如何验证此故事独立运行]

### 用户故事 2 的测试（可选 —— 仅在要求测试时包含） ⚠️

- [ ] T018 [P] [US2] 在 tests/contract/test_[名称].py 中为 [端点] 编写契约测试
- [ ] T019 [P] [US2] 在 tests/integration/test_[名称].py 中为 [用户旅程] 编写集成测试

### 用户故事 2 的实现

- [ ] T020 [P] [US2] 在 src/models/[实体].py 中创建 [实体] 模型
- [ ] T021 [US2] 在 src/services/[服务].py 中实现 [服务]
- [ ] T022 [US2] 在 src/[位置]/[文件].py 中实现 [端点/功能]
- [ ] T023 [US2] 与用户故事 1 的组件集成（如果需要）

**检查点**: 此时，用户故事 1 和 2 应都能独立运行

---

## 第 5 阶段：用户故事 3 - [标题] (优先级：P3)

**目标**: [简要描述此故事交付的内容]

**独立测试**: [如何验证此故事独立运行]

### 用户故事 3 的测试（可选 —— 仅在要求测试时包含） ⚠️

- [ ] T024 [P] [US3] 在 tests/contract/test_[名称].py 中为 [端点] 编写契约测试
- [ ] T025 [P] [US3] 在 tests/integration/test_[名称].py 中为 [用户旅程] 编写集成测试

### 用户故事 3 的实现

- [ ] T026 [P] [US3] 在 src/models/[实体].py 中创建 [实体] 模型
- [ ] T027 [US3] 在 src/services/[服务].py 中实现 [服务]
- [ ] T028 [US3] 在 src/[位置]/[文件].py 中实现 [端点/功能]

**检查点**: 所有用户故事现在都应能独立运行

---

[根据需要添加更多用户故事阶段，遵循相同的模式]

---

## 第 N 阶段：润色与横向关注点

**目的**: 影响多个用户故事的改进

- [ ] TXXX [P] 更新 docs/ 中的文档
- [ ] TXXX 代码清理和重构
- [ ] TXXX 跨所有故事的性能优化
- [ ] TXXX [P] 在 tests/unit/ 中添加额外的单元测试（如果要求）
- [ ] TXXX 安全加固
- [ ] TXXX 运行 quickstart.md 验证

---

## 依赖关系与执行顺序

### 阶段依赖

- **设置（第 1 阶段）**: 无依赖 —— 可以立即开始
- **基础工作（第 2 阶段）**: 依赖于“设置”阶段完成 —— 阻塞所有用户故事
- **用户故事（第 3 阶段+）**: 全部依赖于“基础工作”阶段完成
  - 用户故事随后可以并行进行（如果人力允许）
  - 或者按优先级顺序（P1 → P2 → P3）顺序进行
- **润色（最终阶段）**: 依赖于所有预期的用户故事完成

### 用户故事间的依赖

- **用户故事 1 (P1)**: 可以在基础工作（第 2 阶段）之后开始 —— 不依赖于其他故事
- **用户故事 2 (P2)**: 可以在基础工作（第 2 阶段）之后开始 —— 可能与 US1 集成，但应是可独立测试的
- **用户故事 3 (P3)**: 可以在基础工作（第 2 阶段）之后开始 —— 可能与 US1/US2 集成，但应是可独立测试的

### 每个用户故事内部

- 测试（如果包含）必须在实现之前编写，并且确保是失败 (FAIL) 的
- 先模型，后服务
- 先服务，后端点
- 先核心实现，后集成
- 完成一个故事后再开始下一个优先级的故事

### 并行机会

- 所有标记为 [P] 的“设置”任务可以并行运行
- 所有标记为 [P] 的“基础工作”任务可以并行运行（在第 2 阶段内）
- 一旦基础工作阶段完成，所有用户故事都可以并行开始（如果团队能力允许）
- 用户故事中所有标记为 [P] 的测试可以并行运行
- 故事中标记为 [P] 的模型可以并行运行
- 不同的用户故事可以由不同的团队成员并行处理

---

## 并行示例：用户故事 1

```bash
# 同时启动用户故事 1 的所有测试（如果要求测试）：
任务: "在 tests/contract/test_[名称].py 中为 [端点] 编写契约测试"
任务: "在 tests/integration/test_[名称].py 中为 [用户旅程] 编写集成测试"

# 同时启动用户故事 1 的所有模型：
任务: "在 src/models/[实体1].py 中创建 [实体1] 模型"
任务: "在 src/models/[实体2].py 中创建 [实体2] 模型"
```

---

## 实现策略

### MVP 优先（仅限用户故事 1）

1. 完成第 1 阶段：设置
2. 完成第 2 阶段：基础工作（关键 —— 阻塞所有故事）
3. 完成第 3 阶段：用户故事 1
4. **停止并验证**: 独立测试用户故事 1
5. 如果就绪，进行部署/演示

### 增量交付

1. 完成 设置 + 基础工作 → 基础就绪
2. 添加用户故事 1 → 独立测试 → 部署/演示 (MVP!)
3. 添加用户故事 2 → 独立测试 → 部署/演示
4. 添加用户故事 3 → 独立测试 → 部署/演示
5. 每个故事都在不破坏之前故事的情况下增加价值

### 团队并行策略

对于多名开发人员：

1. 团队共同完成 设置 + 基础工作
2. 基础工作完成后：
   - 开发人员 A：用户故事 1
   - 开发人员 B：用户故事 2
   - 开发人员 C：用户故事 3
3. 各故事独立完成并集成

---

## 备注

- [P] 任务 = 不同文件，无依赖关系
- [故事] 标签将任务映射到特定用户故事，以便追溯
- 每个用户故事都应能独立完成并测试
- 在实现之前验证测试是否失败
- 在完成每个任务或逻辑组后进行提交
- 在任何检查点停止以独立验证故事
- 避免：模糊的任务、相同文件的冲突、破坏独立性的跨故事依赖
